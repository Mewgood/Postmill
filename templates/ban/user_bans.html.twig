{% extends 'base.html.twig' %}
{% use '_layouts/single_column.html.twig' %}
{% from 'user/_macros.html.twig' import user_link %}

{% block title 'title.active_global_user_bans'|trans %}
{% block main_classes 'container container--two-col-expand vertical-pad vp vp--guttered' %}

{% block head %}
  {{ include('_includes/meta_pagination.html.twig', {pager: bans}, with_context=false) }}
{% endblock %}

{% block body %}
  <header class="nav nav--guttered nav--align-end nav--justify-space-between pad">
    <h1 class="no-margin">{{ block('title') }}</h1>
    {{ include('ban/_tabs.html.twig', {page: 'user_bans'}, with_context=false) }}
  </header>

  {% if bans|length > 0 %}
    <table class="table">
      <thead>
        <tr>
          <th class="table__shrink">{{ 'label.username'|trans }}</th>
          <th class="table__shrink">{{ 'label.banned_by'|trans }}</th>
          <th class="table__shrink">{{ 'label.banned'|trans }}</th>
          <th class="table__shrink">{{ 'label.expires'|trans }}</th>
          <th>{{ 'label.reason'|trans }}</th>
          <th class="table__shrink"></th>
        </tr>
      </thead>
      <tbody>
        {% for ban in bans %}
          <tr>
            <td class="table__shrink">{{ user_link(ban.user) }}</td>
            <td class="table__shrink">{{ user_link(ban.bannedBy) }}</td>
            <td class="table__shrink">
              {% with { date: ban.timestamp|localizeddate('long', 'short') } %}
                <time datetime="{{ ban.timestamp|date('c') }}" title="{{ date }}" class="relative-time">
                  {{- date -}}
                </time>
              {% endwith %}
            </td>
            <td class="table__shrink">
              {% if ban.expiresAt %}
                {% set date = ban.expiresAt|localizeddate('long', 'short') %}
                <time datetime="{{ ban.expiresAt|date('c') }}" title="{{ date }}" class="relative-time">
                  {{- date -}}
                </time>
              {% else %}
                {{ 'label.never'|trans }}
              {% endif %}
            </td>
            <td>{{ ban.reason }}</td>
            <td class="table__shrink">
              <a href="{{ path('unban_user', {username: ban.user.username}) }}" class="button button--inline">
                {{- 'action.unban'|trans -}}
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="pad">
      {{ include('_includes/pagination.html.twig', {pager: bans}, with_context=false) }}
    </div>
  {% else %}
    <p class="pad"><small class="dimmed">{{ 'flash.no_entries_to_display'|trans }}</small></p>
  {% endif %}
{% endblock %}
