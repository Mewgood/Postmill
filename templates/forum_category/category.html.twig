{% extends 'base.html.twig' %}

{% from 'submission/_macros.html.twig' import submission, submission_sort %}

{% block title 'heading.category'|trans({'%category%': category.title}) %}

{% block head %}
  {{ parent() }}
  <meta name="description" content="{{ category.description }}">
{% endblock %}

{% block sidebar_top_classes 'card' %}
{% block sidebar_top %}
  <section class="container pad vertical-pad">
    <h4>/c/{{ category.name }}</h4>

    <div class="break-text">
      {{ category.sidebar|cached_markdown|raw }}
    </div>

    {% if is_granted('ROLE_ADMIN') %}
      <nav>
        <p class="no-margin">
          <a href="{{ path('edit_forum_category', {name: category.name}) }}"
             class="button button--inline">
            {{- 'action.edit'|trans -}}
          </a>
        </p>
      </nav>
    {% endif %}
  </section>
{% endblock sidebar_top %}

{% block sidebar_bottom_classes 'container' %}
{% block sidebar_bottom %}
  <section class="card">
    <h4 class="no-margin pad vertical-pad">{{ 'label.forums_in_this_category'|trans }}</h2>

    <ul class="unlistify">
      {% for forum in forums %}
        <li><a href="{{ path('forum', {forum_name: forum}) }}" class="menu-link">{{ forum }}</a></li>
      {% endfor %}
    </ul>
  </section>
{% endblock sidebar_bottom %}

{% block main_classes 'container vp vp--guttered vertical-pad' %}
{% block body %}
  <header class="nav nav--guttered pad">
    <h1 class="no-margin">{{ 'heading.category'|trans({'%category%': category.title}) }}</h1>
    <nav>{{- submission_sort(sort_by) -}}</nav>
  </header>

  {% if submissions|length > 0 %}
    <div class="vp vp--guttered card">
      {% for submission in submissions %}
        {{ submission(submission) }}
      {% endfor %}
    </div>

    {{ include('_includes/pagination.html.twig', {pager: submissions}, with_context=false) }}
  {% else %}
    <p class="pad"><small class="dimmed">{{ 'flash.no_entries_to_display'|trans }}</small></p>
  {% endif %}

{% endblock body %}
